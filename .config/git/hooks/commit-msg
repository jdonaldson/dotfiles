#!/bin/bash
#
# Global commit-msg hook: Block commits with Claude/AI signatures
#

commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")

# Patterns to block
bad_patterns=(
    "Co-Authored-By:.*[Cc]laude"
    "Co-Authored-By:.*[Aa]nthropic"
    "Generated by Claude"
    "Generated by AI"
    "Created by Claude"
)

for pattern in "${bad_patterns[@]}"; do
    if echo "$commit_msg" | grep -qE "$pattern"; then
        echo ""
        echo "❌ COMMIT BLOCKED: Contains Claude/AI signature!"
        echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
        echo "Found pattern: $pattern"
        echo ""
        echo "Remove the signature and try again."
        echo ""
        tput bel 2>/dev/null || true
        exit 1
    fi
done

exit 0
